{"version":3,"sources":["redux-flow/reducers/tic-tac-toe/actions.js","redux-flow/reducers/tic-tac-toe/action-creators.js","components/Square.js","components/Board.js","redux-flow/reducers/identification/actions.js","redux-flow/reducers/identification/action-creators.js","pages/game.js","pages/menu.js","App.js","domain/game.js","redux-flow/reducers/tic-tac-toe/handlers.js","redux-flow/reducers/tic-tac-toe/index.js","redux-flow/reducers/identification/handlers.js","redux-flow/reducers/identification/index.js","redux-flow/reducers/index.js","nun.js","redux-flow/configuration/devtools.js","index.js","redux-flow/configuration/index.js"],"names":["TIC_TAC_TOE_PREFIX","RESET_GAME","FILL_SQUARE","JOIN_GAME","JOIN_ROOM","SYNC_GAME_STATE","joinGame","player","type","payload","syncGameState","state","Container","styled","div","squareSize","Square","children","onClick","boardSize","Board","board","useSelector","ticTacToe","userName","identification","dispatch","useDispatch","map","row","rowIndex","symbol","columnIndex","column","fillSquare","String","SET_IDENTIFICATION","SET_ROOM","setRoom","room","duringGameMessage","GamePage","winner","plays","maxPlays","X","O","roomName","useParams","useState","message","setMessage","useEffect","winMessage","joinRoom","to","MenuPage","store","handleClick","useCallback","e","preventDefault","htmlFor","name","onInput","setIdentification","target","value","App","path","symbols","Object","freeze","initialState","Array","fill","firstSymbol","id","Date","getTime","nextSymbol","computeWinnerSymbol","rows","columns","getBoardColumns","diagonals","getBoardDiagonals","squareGroups","computeSquaresGroupsWinnerSymbol","squaresGroups","find","squaresGroup","targetSymbol","every","reduce","i","getBoardDescendingDiagonal","getBoardAscendingDiagonal","_","valueIndex","length","canFillSquare","rightPlayer","getNextPlayer","notFilled","notOver","getPlayerFromSymbol","computeNewBoard","oldRow","oldRowIndex","oldValue","oldValueIndex","computeNextSymbol","playsAfterSquaredIsFilled","computePlays","symbolQuantity","handleResetState","handleFillSquare","action","newBoard","winnerSymbol","tryToFillSquare","handleJoinGame","hasX","playerSymbol","handleJoinRoom","handleSyncGameState","handleSetIdentification","handleSetRoom","combineReducers","nun","NunDb","process","ticTacToeAction","RegExp","dbMiddleware","next","a","myPlayerId","getState","getValue","watch","nunAction","playerId","test","tmpAction","setValue","devtools","window","__REDUX_DEVTOOLS_EXTENSION__","x","createStore","rootReducer","compose","applyMiddleware","configureStore","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9f047c13.chunk.js","sourcesContent":["export const TIC_TAC_TOE_PREFIX = '@@tic-tac-toe';\nexport const RESET_GAME = `${TIC_TAC_TOE_PREFIX}:RESET_GAME`;\nexport const FILL_SQUARE = `${TIC_TAC_TOE_PREFIX}:FILL_SQUARE`;\nexport const JOIN_GAME = `${TIC_TAC_TOE_PREFIX}:JOIN_GAME`;\nexport const JOIN_ROOM = `${TIC_TAC_TOE_PREFIX}:JOIN_ROOM`;\nexport const SYNC_GAME_STATE = `${TIC_TAC_TOE_PREFIX}:SYNC_GAME_STATE`;\n","import {\n  RESET_GAME,\n  FILL_SQUARE,\n  JOIN_GAME,\n  JOIN_ROOM,\n  SYNC_GAME_STATE,\n} from './actions';\n\nexport const joinRoom = (roomName) => ({\n  type: JOIN_ROOM,\n  payload: {\n    roomName,\n  },\n});\n\nexport const resetGame = (boardSize) => ({\n  type: RESET_GAME,\n  payload: {\n    boardSize,\n  },\n});\n\nexport const fillSquare = ({ row, column, player }) => ({\n  type: FILL_SQUARE,\n  payload: {\n    row, column, player,\n  },\n});\n\nexport const joinGame = (player) => ({\n  type: JOIN_GAME,\n  payload: {\n    player,\n  },\n});\n\nexport const syncGameState = (state) => ({\n  type: SYNC_GAME_STATE,\n  payload: {\n    state,\n  },\n});\n","import React from 'react';\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\n\nconst Container = styled.div`\n    width: ${({ squareSize }) => `${squareSize - 2}px`};\n    height: ${({ squareSize }) => `${squareSize - 2}px`};\n\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    text-align: center;\n\n    font-size: 2.5em;\n\n    border: solid 1px black;\n\n    /* guarantee no text selection  */\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Old versions of Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently */\n`;\n\nconst Square = ({ children, squareSize, onClick }) => (\n  <Container\n    squareSize={squareSize}\n    onClick={onClick}\n  >\n    {children}\n  </Container>\n);\n\nSquare.propTypes = {\n  squareSize: PropTypes.number.isRequired,\n  children: PropTypes.string.isRequired,\n  onClick: PropTypes.func.isRequired,\n};\n\nexport default Square;\n","import React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport styled from 'styled-components';\nimport { fillSquare } from '../redux-flow/reducers/tic-tac-toe/action-creators';\nimport Square from './Square';\n\nconst Container = styled.div`\n    height: ${({ boardSize }) => `${boardSize}px`};\n    width: ${({ boardSize }) => `${boardSize}px`};\n\n    display: flex;\n    flex-direction: row;\n    align-items: space-around;\n    justify-content: center;\n    flex-wrap: wrap;\n`;\n\nconst boardSize = 300;\nconst squareSize = boardSize / 3;\n\nconst Board = () => {\n  const { board } = useSelector((state) => state.ticTacToe);\n  const { userName } = useSelector((state) => state.identification);\n  const dispatch = useDispatch();\n\n  return (\n    <Container boardSize={boardSize}>\n      {board.map((row, rowIndex) => row.map((symbol, columnIndex) => (\n        <Square\n          squareSize={squareSize}\n          key={String(rowIndex) + String(columnIndex)}\n          onClick={() => {\n            dispatch(fillSquare({\n              column: columnIndex,\n              row: rowIndex,\n              player: userName,\n            }));\n          }}\n        >\n          {symbol}\n        </Square>\n      )))}\n    </Container>\n  );\n};\n\nexport default Board;\n","export const SET_IDENTIFICATION = '@@identification:SET_IDENTIFICATION';\nexport const SET_ROOM = '@@identification:SET_ROOM';\n","import {\n  SET_IDENTIFICATION,\n  SET_ROOM,\n} from './actions';\n\nexport const setIdentification = (userName) => ({\n  type: SET_IDENTIFICATION,\n  payload: {\n    userName,\n  },\n});\n\nexport const setRoom = (room) => ({\n  type: SET_ROOM,\n  payload: {\n    room,\n  },\n});\n","import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport styled from 'styled-components';\nimport { useParams, Link } from 'react-router-dom';\nimport Board from '../components/Board';\nimport { resetGame, joinRoom } from '../redux-flow/reducers/tic-tac-toe/action-creators';\nimport { setRoom } from '../redux-flow/reducers/identification/action-creators';\n\nconst Container = styled.div`\n  width: 95vw;\n  height: 95vh;\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n\n  font-family: sans-serif;\n`;\n\nconst duringGameMessage = 'Click a square';\nconst drawMessage = 'No winner';\nconst winMessage = (winner) => `Winner: ${winner}`;\n\nconst GamePage = () => {\n  const {\n    winner,\n    plays,\n    maxPlays,\n    X,\n    O,\n  } = useSelector((state) => state.ticTacToe);\n  const { userName } = useSelector((state) => state.identification);\n  const { roomName } = useParams();\n  const dispatch = useDispatch();\n  const [message, setMessage] = useState(duringGameMessage);\n\n  useEffect(() => {\n    if (winner) {\n      return setMessage(winMessage(winner));\n    }\n    if (plays >= maxPlays) {\n      return setMessage(drawMessage);\n    }\n    return setMessage(duringGameMessage);\n  }, [winner, plays, maxPlays]);\n\n  useEffect(() => {\n    dispatch(setRoom(roomName));\n    dispatch(joinRoom(roomName));\n  }, []);\n\n  return (\n    <Container>\n      <p>\n        {userName\n          ? `Your user name: ${userName}`\n          : \"You're viewing the game as a guest\"}\n      </p>\n      <p>\n        Player X:\n        {' '}\n        {X}\n      </p>\n      <p>\n        Player O:\n        {' '}\n        {O}\n      </p>\n      <Board />\n      <p>{message}</p>\n      <button type=\"button\" onClick={() => dispatch(resetGame())}>Reset Game</button>\n      <Link to=\"/\">\n        <p>Menu</p>\n      </Link>\n    </Container>\n  );\n};\n\nexport default GamePage;\n","import React, { useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport styled from 'styled-components';\nimport { Link } from 'react-router-dom';\nimport { setIdentification, setRoom } from '../redux-flow/reducers/identification/action-creators';\n\nconst Container = styled.div`\n  width: 95vw;\n  height: 95vh;\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n\n  font-family: sans-serif;\n`;\n\nconst MenuPage = () => {\n  const { userName, room: roomName } = useSelector((store) => store.identification);\n  const dispatch = useDispatch();\n\n  const handleClick = useCallback((e) => {\n    if (!roomName) {\n      e.preventDefault();\n    }\n  }, [roomName]);\n\n  return (\n    <Container>\n      <div>\n        <label htmlFor=\"userName\">\n          <p>\n            Type in your username:\n          </p>\n          <input\n            name=\"userName\"\n            onInput={(e) => dispatch(setIdentification(e.target.value))}\n            value={userName}\n          />\n        </label>\n      </div>\n      <div>\n        <label htmlFor=\"roomName\">\n          <p>\n            Type in the room name:\n          </p>\n          <input\n            name=\"roomName\"\n            onInput={(e) => dispatch(setRoom(e.target.value))}\n            value={roomName}\n          />\n        </label>\n        <Link\n          to={`/room/${roomName}`}\n          onClick={handleClick}\n        >\n          <p>Join room</p>\n        </Link>\n      </div>\n    </Container>\n  );\n};\n\nexport default MenuPage;\n","import React from 'react';\nimport { HashRouter as Router, Switch, Route } from 'react-router-dom';\nimport GamePage from './pages/game';\nimport MenuPage from './pages/menu';\n\nconst App = () => (\n  <Router>\n    <Switch>\n      <Route path=\"/room/:roomName\">\n        <GamePage />\n      </Route>\n      <Route path=\"/\">\n        <MenuPage />\n      </Route>\n    </Switch>\n  </Router>\n);\n\nexport default App;\n","export const symbols = Object.freeze(['X', 'O']);\n\nexport const initialState = () => {\n  const BOARD_SIZE = 3;\n  const maxPlays = BOARD_SIZE ** 2;\n  const rows = new Array(BOARD_SIZE).fill([]);\n  const board = rows.map(() => new Array(BOARD_SIZE).fill(''));\n  const [firstSymbol] = symbols;\n  return {\n    id: (new Date().getTime()),\n    X: null,\n    O: null,\n    winner: null,\n    roomName: null,\n    maxPlays,\n    board,\n    nextSymbol: firstSymbol,\n    plays: 0,\n  };\n};\n\nexport const joinRoom = ({ state, roomName }) => ({\n  ...state,\n  roomName,\n});\n\nexport const joinGame = ({ state, player }) => {\n  const hasX = !!state.X;\n  if (state.X && state.O) return state;\n  if (hasX && state.X === player) return state;\n  const playerSymbol = hasX ? 'O' : 'X';\n  return {\n    ...state,\n    [playerSymbol]: player,\n  };\n};\n\nexport const tryToFillSquare = ({\n  state, row, column, player,\n}) => {\n  if (!canFillSquare({\n    state, row, column, player,\n  })) {\n    return state;\n  }\n  const newBoard = computeNewBoard({ state, row, column });\n  const winnerSymbol = computeWinnerSymbol(newBoard);\n  const winner = getPlayerFromSymbol({ state, symbol: winnerSymbol });\n\n  return ({\n    ...state,\n    board: newBoard,\n    nextSymbol: computeNextSymbol(state),\n    plays: computePlays(state),\n    winner,\n  });\n};\n\nconst computeWinnerSymbol = (board) => {\n  const rows = [...board];\n  const columns = getBoardColumns(board);\n  const diagonals = getBoardDiagonals(board);\n  const squareGroups = [\n    ...rows,\n    ...columns,\n    ...diagonals,\n  ];\n  const winnerSymbol = computeSquaresGroupsWinnerSymbol(squareGroups);\n  return winnerSymbol;\n};\n\nconst computeSquaresGroupsWinnerSymbol = (squaresGroups) => squaresGroups\n  .find((squaresGroup) => {\n    const [targetSymbol] = squaresGroup;\n    return squaresGroup.every((value) => value !== '' && value === targetSymbol);\n  })?.[0];\n\nconst getBoardColumns = (board) => board\n  .reduce((columns, row) => [0, 1, 2]\n    .map((i) => [...columns[i], row[i]]), [[], [], []]);\n\nconst getBoardDiagonals = (board) => {\n  const descendingDiagonal = getBoardDescendingDiagonal(board);\n  const ascendingDiagonal = getBoardAscendingDiagonal(board);\n  return [descendingDiagonal, ascendingDiagonal];\n};\n\nconst getBoardDescendingDiagonal = (board) => board\n  .map((row, rowIndex) => row.find((_, valueIndex) => valueIndex === rowIndex));\n\nconst getBoardAscendingDiagonal = (board) => board\n  .map((row, rowIndex) => row.find((_, valueIndex) => valueIndex + rowIndex === board.length - 1));\n\nconst canFillSquare = ({\n  state, row, column, player,\n}) => {\n  const nextPlayer = getNextPlayer(state);\n  const rightPlayer = player === nextPlayer;\n  const notFilled = !state.board[row][column];\n  const notOver = !state.winner;\n  return rightPlayer && notFilled && notOver;\n};\n\nconst getNextPlayer = (state) => getPlayerFromSymbol({ state, symbol: state.nextSymbol });\n\nconst getPlayerFromSymbol = ({ state, symbol }) => state[symbol] || null;\n\nconst computeNewBoard = ({ state, row, column }) => state.board.map((oldRow, oldRowIndex) => {\n  if (oldRowIndex !== row) {\n    return oldRow;\n  }\n\n  return oldRow.map((oldValue, oldValueIndex) => {\n    if (oldValueIndex === column) {\n      return state.nextSymbol;\n    }\n    return oldValue;\n  });\n});\n\nconst computeNextSymbol = (state) => {\n  const playsAfterSquaredIsFilled = computePlays(state);\n  const symbolQuantity = symbols.length;\n  const nextSymbolIndex = playsAfterSquaredIsFilled % symbolQuantity;\n  return symbols[nextSymbolIndex];\n};\n\nconst computePlays = (state) => state.plays + 1;\n","import {\n  initialState,\n  tryToFillSquare,\n  joinGame,\n  joinRoom,\n} from '../../../domain/game';\n\nexport const handleResetState = () => initialState();\n\nexport const handleFillSquare = (state, action) => {\n  const { row, column, player } = action.payload;\n  const newState = tryToFillSquare({\n    state,\n    row,\n    column,\n    player,\n  });\n  return newState;\n};\n\nexport const handleJoinGame = (state, action) => {\n  const { player } = action.payload;\n  const newState = joinGame({ state, player });\n  return newState;\n};\n\nexport const handleJoinRoom = (state, action) => {\n  const { roomName } = action.payload;\n  const newState = joinRoom({ state, roomName });\n  return newState;\n};\n\nexport const handleSyncGameState = (_, action) => action.payload.state;\n","import {\n  FILL_SQUARE,\n  RESET_GAME,\n  JOIN_GAME,\n  JOIN_ROOM,\n  SYNC_GAME_STATE,\n} from './actions';\nimport {\n  handleResetState,\n  handleFillSquare,\n  handleJoinGame,\n  handleJoinRoom,\n  handleSyncGameState,\n} from './handlers';\nimport { initialState } from '../../../domain/game';\n\nconst ticTacToe = (state = initialState(), action) => {\n  switch (action.type) {\n    case RESET_GAME:\n      return handleResetState(state, action);\n    case FILL_SQUARE:\n      return handleFillSquare(state, action);\n    case JOIN_GAME:\n      return handleJoinGame(state, action);\n    case JOIN_ROOM:\n      return handleJoinRoom(state, action);\n    case SYNC_GAME_STATE:\n      return handleSyncGameState(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default ticTacToe;\n","export const handleSetIdentification = (state, action) => {\n  const { userName } = action.payload;\n  return {\n    ...state,\n    userName,\n  };\n};\n\nexport const handleSetRoom = (state, action) => {\n  const { room } = action.payload;\n  return {\n    ...state,\n    room,\n  };\n};\n","import { SET_IDENTIFICATION, SET_ROOM } from './actions';\nimport { handleSetIdentification, handleSetRoom } from './handlers';\n\nconst identification = (state = {}, action) => {\n  switch (action.type) {\n    case SET_IDENTIFICATION:\n      return handleSetIdentification(state, action);\n    case SET_ROOM:\n      return handleSetRoom(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default identification;\n","import { combineReducers } from 'redux';\nimport ticTacToe from './tic-tac-toe';\nimport identification from './identification';\n\nexport default combineReducers({\n  ticTacToe,\n  identification,\n});\n","import NunDb from 'nun-db';\nimport { syncGameState, joinGame } from './redux-flow/reducers/tic-tac-toe/action-creators';\nimport { TIC_TAC_TOE_PREFIX, JOIN_ROOM } from './redux-flow/reducers/tic-tac-toe/actions';\n\nconst nun = new NunDb(\n  process.env.REACT_APP_NUN_DB_URL,\n  process.env.REACT_APP_NUN_DB_USER,\n  process.env.REACT_APP_NUN_DB_PWD,\n);\n\nconst ticTacToeAction = new RegExp(`^${TIC_TAC_TOE_PREFIX}`);\nconst dbMiddleware = (store) => (next) => async (action) => {\n  next(action);\n  const myPlayerId = store.getState().ticTacToe.id;\n  const roomName = store.getState().identification.room;\n  if (action.type === JOIN_ROOM) {\n    try {\n      const state = await nun.getValue(roomName);\n      store.dispatch(syncGameState(state.ticTacToe));\n      store.dispatch(joinGame(store.getState().identification.userName));\n    } catch (e) { // in case the room wasn't created yet\n      store.dispatch(joinGame(store.getState().identification.userName));\n    }\n\n    nun.watch(`lastEvent-${roomName}`, (nunAction) => {\n      if (nunAction.playerId === myPlayerId) {\n        return false;\n      }\n      if (ticTacToeAction.test(nunAction.value.type)) {\n        store.dispatch(nunAction.value);\n      }\n      return true;\n    });\n    return;\n  }\n  if (ticTacToeAction.test(action.type) && !action.playerId) {\n    const tmpAction = { ...action, playerId: myPlayerId };\n    nun.setValue(`lastEvent-${roomName}`, tmpAction);\n    nun.setValue(store.getState().identification.room, store.getState());\n  }\n};\n\nexport {\n  nun,\n  dbMiddleware,\n};\n","/* eslint-disable no-underscore-dangle */\nconst devtools = () => (window.__REDUX_DEVTOOLS_EXTENSION__\n  ? window.__REDUX_DEVTOOLS_EXTENSION__()\n  : (x) => x);\n/* eslint-enable */\n\nexport default devtools;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport App from './App';\nimport configureStore from './redux-flow/configuration';\n\nconst store = configureStore();\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport rootReducer from '../reducers';\nimport { dbMiddleware } from '../../nun';\nimport devtools from './devtools';\n\nexport default ({ initialState } = {}) => {\n  const store = createStore(\n    rootReducer,\n    initialState,\n    compose(\n      applyMiddleware(dbMiddleware),\n      devtools(),\n    ),\n  );\n\n  return store;\n};\n"],"sourceRoot":""}